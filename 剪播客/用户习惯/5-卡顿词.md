<!--
input: 全文文本
output: 卡顿词索引列表
pos: 规则，建议删优先级

架构守护者：一旦我被修改，请同步更新：
1. 所属文件夹的 README.md
-->

# 卡顿词

## 模式

同一个词连续说 2-3 次：

```javascript
const stutterPatterns = [
  '那个那个',
  '就是就是',
  '然后然后',
  '这个这个',
  '所以所以'
];
```

## 叠词排除（重要！避免误判）

以下中文叠词是**正常表达**，不是卡顿，**必须跳过**：

```javascript
const REDUPLICATED_WORDS = new Set([
  // AA 式：亲属称谓
  '妈妈', '爸爸', '宝宝', '哥哥', '姐姐', '弟弟', '奶奶', '爷爷',
  '叔叔', '阿姨', '婆婆', '公公', '舅舅', '姑姑', '伯伯',
  // AA 式：日常用语
  '谢谢', '星星', '多多', '甜甜', '乖乖', '饭饭',
  // 动词重叠 AA 式
  '试试', '看看', '想想', '说说', '聊聊', '走走', '听听', '等等',
  '谈谈', '讲讲', '写写', '读读', '坐坐', '玩玩', '猜猜', '问问',
  // 拟声叠词
  '哈哈', '嘻嘻', '呵呵', '嘿嘿', '噗噗',
]);

// 拟声叠词 AAA/AAAA 模式（如"哈哈哈"、"哈哈哈哈"）
const ONOMATOPOEIA_BASES = ['哈', '嘻', '呵', '嘿', '噗', '啦'];

// AAB / ABB 式（如"慢慢地"、"轻轻地"、"好好的"）
const AAX_PATTERNS = /^(.)\1(地|的|儿|来|去|看|说)$/;

// AABB 式（如"开开心心"、"高高兴兴"、"平平安安"）
const AABB_PATTERN = /^(.)(.)(\1)(\2)$/;
```

### 排除逻辑

```javascript
function isReduplicated(currentWord, nextWord, fullContext) {
  const combined = currentWord + nextWord;

  // 1. 在叠词白名单中
  if (REDUPLICATED_WORDS.has(combined)) return true;

  // 2. 拟声词连续 ≥2 次（哈哈哈、嘻嘻嘻）
  if (ONOMATOPOEIA_BASES.includes(currentWord) &&
      currentWord === nextWord) return true;

  // 3. AAB/ABB 式：两个相同字 + 后缀
  if (AAX_PATTERNS.test(combined)) return true;

  // 4. AABB 式
  if (AABB_PATTERN.test(combined)) return true;

  return false;
}
```

**关键原则**：如果两个相邻的相同词组合在一起是一个有意义的中文词语（叠词），则不是卡顿。**宁可漏检，不可误删正常叠词**。

## 扩展模式：任意词连续重复

除固定列表外，**任何词连续出现2次**都应检测为卡顿词，**但必须先排除叠词**：

```javascript
// 动态检测：相邻两个相同词（排除叠词）
if (words[i].text === words[i+1].text && words[i].text.length >= 1) {
  if (!isReduplicated(words[i].text, words[i+1].text)) {
    // 卡顿词，删前面保留后面
  }
}
```

### 常见遗漏案例

| 原文 | 卡顿词 | 删除 |
|------|--------|------|
| 第一第一份工作 | 第一 | 前一个"第一" |
| 我我最近 | 我 | 前一个"我" |
| 但但是 | 但 | "但" |
| 放放到台面 | 放 | 前一个"放" |

**关键**：不要只依赖固定列表，任何相邻重复词都是卡顿。

## 删除策略

删前面，保留最后一个。

```
原文: "那个那个我想说"
删除: "那个"
保留: "那个我想说"

原文: "第一第一份工作"
删除: "第一"
保留: "第一份工作"
```
