<!--
input: subtitles_words.json
output: 重说纠正索引列表
pos: 规则，建议删优先级

架构守护者：一旦我被修改，请同步更新：
1. 所属文件夹的 README.md
-->

# 重说纠正

## 模式

说错后立即纠正，删除前面错误的部分。

### 1. 部分重复

前后词语有重叠但不完全相同：

| 原文 | 删除 |
|------|------|
| 你再关你关掉 | "你再关" |
| 怎么让它去有个更大的 | "怎么让它去" |

### 2. 否定纠正

用否定词纠正刚说的：

| 原文 | 删除 |
|------|------|
| 它是它不是 | "它是" |
| 可以不可以 | "可以" |

### 3. 词被打断

词说一半 + 静音 + 重说完整：

| 原文 | 删除 |
|------|------|
| 依赖[静]依赖关系 | "依赖[静]" |

### 4. 句中半截重说

说到一半发现错了，换个说法重新开始。前面半截不完整的部分应删除：

| 原文 | 删除 | 说明 |
|------|------|------|
| 去裁了只被我困在 | "去裁了只被" | 说错后重新组织语言 |
| 五年之这五年间 | "五年之" | "五年之"是半截，后面纠正为"这五年间" |
| 你的对你对世界的 | "你的对" | "你的对"是半截，纠正为"你对世界的" |

### 5. 指代修正

前后主语或修饰语改变：

| 原文 | 删除 | 说明 |
|------|------|------|
| 你的对你对世界的观察 | "你的对" | 改了修饰结构 |

## 检测逻辑

```javascript
// 方法1：找相邻词的公共前缀
if (word[i].text.startsWith(prefix) && word[i+n].text.startsWith(prefix)) {
  // 且后者更完整 → 删前者
}

// 方法2：窗口扫描 — 在 5-8 词窗口内找重复起始词
// "五年之...这五年间" → "五年" 出现两次，前面那截不完整 → 删
// "你的对...你对世界的" → "你" 出现两次，前面那截不完整 → 删
// 关键：后面的版本比前面的更完整/通顺
```

**难点**：这类重说不一定有公共前缀，而是"说了几个字发现不对→停顿→换说法重来"。需要结合 AI 语义理解判断哪部分是废弃的半截。

## 删除边界原则（极重要！）

**只删卡顿/错误前缀，保留最终正确表达。** 这是重说纠正最容易犯错的地方。

### ❌ 常见错误：过度删除

| 原文 | 错误删除 | 结果 | 问题 |
|------|----------|------|------|
| 就是就是努力。 | "就是就是努力。" | 整句没了 | "努力"是关键语义 |
| 但最后最后其实我也没当上 | "但最后" | 失去"但"连接词 | "但"有语义作用 |
| 怎么能能能能能做到，对吧？ | 整句 | 整句没了 | 内容完全丢失 |
| 所以我觉得啊，我的第二个关键词可能就是就是就是探索。 | 整句 | 整句没了 | 关键内容"第二个关键词是探索"丢失 |

### ✅ 正确做法

| 原文 | 正确删除 | 保留 |
|------|----------|------|
| 就是就是努力。 | "就是" | "就是努力。" |
| 但最后最后其实我也没当上 | "最后"（一个重复） | "但最后其实我也没当上" |
| 怎么能能能能能做到，对吧？ | "能能能能" | "怎么能做到，对吧？" |
| 所以我觉得啊...就是就是就是探索。 | "就是就是" | "...就是探索。" |

### 三条铁律

1. **保留语义连接词**：但、所以、然后、因为等连接词有语义作用，即使出现在卡顿附近也不能删
2. **保留最终完整表达**：卡顿 N 次后的最后一次是正确版本，必须保留
3. **复杂句拆分处理**：一句中有多处卡顿时，拆成多个独立小编辑，每个只处理一个卡顿点

### 复杂句拆分示例

原文：`对，然后但最后最后其实我也没当上产品经理啊，这是一个但这但这个是有原因的了。`

拆成两个独立编辑：
- 编辑1：删"最后"（'最后最后'卡顿，只删一个重复）
- 编辑2：删"这是一个但这"（保留'但这个是有原因的了'）

结果：`对，然后但最后其实我也没当上产品经理啊，但这个是有原因的了。`
